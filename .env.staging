# Staging Environment Configuration
# This file contains environment variables for Docker Compose label substitution
# and runtime configuration in the staging environment.

# ==============================================================================
# Traefik Routing Configuration
# ==============================================================================
# These variables are used by docker-compose.yml for Traefik label substitution
# They MUST be set for Traefik to route requests correctly

TRAEFIK_ENABLE=true
ENV_SUFFIX=-staging
ENV_DOMAIN_SUFFIX=-staging
INTERNAL_DOMAIN=zitian.party

# ==============================================================================
# Docker Compose Configuration
# ==============================================================================

# Image registry and tag (dynamically set by deployment script)
REGISTRY=ghcr.io
IMAGE_PREFIX=wangzitian0/finance_report
IMAGE_TAG=latest
GIT_COMMIT_SHA=latest

# Compose profiles (app = frontend + backend only, no infra services)
COMPOSE_PROFILES=app

# Container restart policy
RESTART_POLICY=unless-stopped

# ==============================================================================
# Application URLs
# ==============================================================================

# Frontend public URL
NEXT_PUBLIC_APP_URL=https://report-staging.zitian.party

# Backend API URL for frontend (empty = same origin with /api prefix via Traefik)
NEXT_PUBLIC_API_URL=

# ==============================================================================
# Backend Configuration
# ==============================================================================
# Note: Sensitive values (DATABASE_URL, SECRET_KEY, API keys) should be managed
# via Vault or Dokploy secrets, not in this file.

ENV=production
ENVIRONMENT=staging
DEBUG=false
BASE_CURRENCY=SGD

# CORS configuration
CORS_ORIGINS=https://report-staging.zitian.party
CORS_ORIGIN_REGEX=r"https://report(-pr-\d+|-staging)?\.zitian\.party"

# JWT settings
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=1440

# OpenRouter AI (managed via Vault)
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
PRIMARY_MODEL=google/gemini-3-flash-preview
FALLBACK_MODELS=qwen/qwen-2.5-vl-7b-instruct:free,nvidia/nemotron-nano-12b-v2-vl:free
OPENROUTER_DAILY_LIMIT_USD=2

# S3 / MinIO Storage (endpoints managed via Vault)
S3_BUCKET=statements
S3_REGION=us-east-1
S3_PRESIGN_EXPIRY_SECONDS=900

# Observability (SigNoz / OTLP)
OTEL_EXPORTER_OTLP_ENDPOINT=http://platform-signoz-otel-collector:4318
OTEL_SERVICE_NAME=finance-report-backend
OTEL_RESOURCE_ATTRIBUTES=deployment.environment=staging

# Feature Flags
ENABLE_4_LAYER_WRITE=false
ENABLE_4_LAYER_READ=false
ENABLE_LAYER_0_WRITE=true

# ==============================================================================
# SECRETS - Managed via Vault/Dokploy (NOT in this file)
# ==============================================================================
# The following variables should be set via Dokploy UI or Vault:
# - DATABASE_URL
# - SECRET_KEY
# - REDIS_URL
# - OPENROUTER_API_KEY
# - S3_ENDPOINT
# - S3_ACCESS_KEY
# - S3_SECRET_KEY
# - S3_PUBLIC_ENDPOINT (if different from S3_ENDPOINT)
# - S3_PUBLIC_ACCESS_KEY (if different from S3_ACCESS_KEY)
# - S3_PUBLIC_SECRET_KEY (if different from S3_SECRET_KEY)
# - S3_PUBLIC_BUCKET (if different from S3_BUCKET)
