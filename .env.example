# ==============================================================================
# Backend Configuration
# ==============================================================================

# Database
# Use postgresql+asyncpg:// for async FastAPI compatibility
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/finance_report

# App Settings
ENV=development
DEBUG=true
BASE_CURRENCY=SGD

# OpenRouter AI Support (Free Models)
# Required for document extraction and AI advisor
OPENROUTER_API_KEY=
PRIMARY_MODEL=google/gemini-2.0-flash-exp:free
FALLBACK_MODELS=qwen/qwen-2.5-vl-7b-instruct:free,nvidia/nemotron-nano-12b-v2-vl:free
OPENROUTER_DAILY_LIMIT_USD=2

# S3 / MinIO Storage
# Used for storing uploaded statement files
S3_ENDPOINT=http://localhost:9000
S3_ACCESS_KEY=minio
S3_SECRET_KEY=<YOUR_S3_SECRET_KEY>
S3_BUCKET=statements
S3_REGION=us-east-1

# S3 Public Access (for OpenRouter/AI Services)
# REQUIRED in production if S3_ENDPOINT is internal (e.g., http://minio:9000)
# OpenRouter needs publicly accessible URLs to download statement PDFs for parsing
# If not set, system falls back to Base64 encoding (limited to files <5MB)
S3_PUBLIC_ENDPOINT=https://s3.zitian.party
# S3_PUBLIC_ACCESS_KEY=<OPTIONAL_PUBLIC_KEY>
# S3_PUBLIC_SECRET_KEY=<OPTIONAL_PUBLIC_SECRET>
# S3_PUBLIC_BUCKET=<OPTIONAL_PUBLIC_BUCKET>

# Observability (SigNoz / OTLP)
# Optional: set in production to ship logs to SigNoz
# OTEL_EXPORTER_OTLP_ENDPOINT=http://platform-signoz-otel-collector:4318
# OTEL_SERVICE_NAME=finance-report-backend
# OTEL_RESOURCE_ATTRIBUTES=deployment.environment=development

# Redis (Production/Staging only)
# Moved to Security section

# Security
CORS_ORIGINS=http://localhost:3000,http://localhost:3001
SECRET_KEY=generate_a_secure_token_for_production_here
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=1440
# Required for distributed rate limiting
REDIS_URL=redis://localhost:6379/0

# ==============================================================================
# Frontend Configuration
# ==============================================================================

# API URL for frontend requests
# - Development: Leave empty (Next.js rewrites proxy /api to backend)
# - Production: Set to backend URL (e.g., https://report.zitian.party) or leave empty for same-origin
NEXT_PUBLIC_API_URL=

# Frontend app URL for absolute links (redirects, OAuth callbacks, etc.)
# - Development: http://localhost:3000 (default)
# - Production: Set to your public frontend URL (e.g., https://report.zitian.party)
# - PR environments: Auto-set by CI (e.g., https://report-pr-101.zitian.party)
# Note: Also used by backend if it needs to generate links back to the frontend
NEXT_PUBLIC_APP_URL=http://localhost:3000
